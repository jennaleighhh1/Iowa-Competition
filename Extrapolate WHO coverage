```{r}
#Extrapolate time series data
library(caret)
set.seed(1234)
part.WHO <- createDataPartition(y=WHO_vac$coverage, p=0.7, list=FALSE)
train.WHO <- WHO_vac[part.WHO,]
test.WHO <- WHO_vac[-part.WHO,]
```

```{r}
WHO_ts <- ts(train.WHO[,4], start = c(2030,1), end = c(2050,20), frequency = 20)
#mean absolute percentage error
mape.WHO <- function(x, y) {
  return(mean(abs((x-y)/x))*100)
}
```

```{r}
#Naive forecasting 
#install.packages("forecast")
library(forecast)
```

```{r}
naive.WHO <- naive(WHO_ts, h=20)
summary(naive.WHO)
```

The naive forecasting method is to use the most recent observation as the forecast for the next observation.
It predicts the same value for the entire forecasting column. 

```{r}
#Evaluate on the test data
library(dplyr)
test.WHO$naive <- 0.45
mape.WHO(test.WHO$coverage, test.WHO$naive)
```

Apparently there is an infinite mean absolute percentage error.

```{r}
#Simple Exponential Smoothing Technique
WHO.se <- ses(WHO_ts, h=20)
summary(WHO.se)
```

Exponential Smoothing methods are an extension of the naive method, wherein the forecasts are produced using weighted averages of past observations, with the weights decaying exponentially as the observations get older. 
We get the same value for all forecasts. 
Alpha is close to 1, so that means the forecasts are closer to the more recent observations.

```{r}
#evaluate the model
WHO.se.eval <- as.data.frame(WHO.se)
test.WHO$simplexp <- 0.4505216
mape.WHO(test.WHO$coverage, test.WHO$simplexp)
```

Also shows infinite error.

```{r}
#Holts trend method
#holt's winter model:
WHO.holt <- holt(WHO_ts, h=20)
summary(WHO.holt)
```

This is an extension of the simple exponential smoothing method which considers the trend component while generating forecasts. This method involves two smoothing equations, one for the level and one for the trend component.
MAPE is still infinite, but we see slight changes in coverage. 

```{r}
plot(naive.WHO)
plot(WHO.se)
plot(WHO.holt)
```

